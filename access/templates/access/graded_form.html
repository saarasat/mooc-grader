{% load i18n %}
{% load access %}
<form method="post" action="{{ post_url }}"{% if result.form.multipart %} enctype="multipart/form-data"{% endif %} class="aplus-quiz1">
	{% for field in result.form %}
	{% if field.field.open_set %}
	<fieldset id="{{ field.field.open_set }}"{% if result.accepted and field.field.group_errors %} class="alert {% if field.field.open_set in result.error_groups %}alert-danger{% else %}alert-success{% endif %}"{% endif %}>
		{% if field.field.set_title %}<legend>{{ field.field.set_title }}</legend>{% endif %}
	{% endif %}

		{% if field.field.type == "static" %}
		{{ field.field.more|safe }}
		{% elif field.field.type == "hidden" %}
			{{ field }}
		{% else %}

		{% if not field.field.row_label or field.field.open_table %}
		<div class="{{ field.field.html_class }}{% if field.errors %} has-error{% endif %}">

			{% if field.field.required %}<span class="required">*</span>{% endif %}

			{% if field.label %}
			{% if field.field.choice_list %}
			<label class="control-label">{{ field.label }}</label>
			{% else %}
			<label class="control-label">{{ field.label_tag }}</label>
			{% endif %}
			{% endif %}

			{% if not field.field.group_errors %}
			{% if result.accepted %}
				{% if not exercise.feedback or field.field.points > 0 %}
				<span class="badge badge-{% if field.field.grade_points > 0 and field.field.grade_points < field.field.max_points %}warning{% elif field.field.name in result.error_fields %}danger{% else %}success{% endif %}">
					{{ field.field.grade_points }} / {{ field.field.max_points }}
				</span>
					{% if field.field.max_points == 0 %}
					<span class="sr-only">
					{% if field.field.name in result.error_fields %}
						{% trans "Incorrect" %}
					{% else %}
						{% trans "Correct" %}
					{% endif %}
					</span>
					{% endif %}
				{% endif %}
			{% else %}
				{% if exercise.max_points > 0 and not exercise.feedback or field.field.points > 0 %}
				<span class="badge">
				{% blocktrans count points=field.field.points %}
				{{ points }} point
				{% plural %}
				{{ points }} points
				{% endblocktrans %}
				</span>
				{% endif %}
			{% endif %}
			{% endif %}

			{% if field.field.more %}
				<p>{{ field.field.more|safe }}</p>
			{% endif %}
		{% endif %}

			{% if field.field.row_label %}
			{% if field.field.open_table %}
			<table class="table">
			<tr>
				<td>&nbsp;</td>
				{% for choice in field %}
				<td>{{ choice.choice_label|safe }}</td>
				{% endfor %}
				{% if field.field.more_text %}
				<td>{{ field.field.more_text|safe }}</td>
				{% endif %}
			</tr>
			{% endif %}

			{% if field.field.table_more %}
				<td>{{ field }}</td>
			</tr>
			{% else %}
			<tr>
				<td>{{ field.field.row_label|safe }}</td>
				{% for choice in field %}
				<td>{{ choice.tag }}</td>
				{% endfor %}
			{% if not field.field.more_text %}
			</tr>
			{% endif %}
			{% endif %}

			{% include "access/field_errors.html" with errors=field.errors table=true %}
			{% if field.field.close_table %}
			</table>
			{% endif %}

			{% elif field.field.choice_list %}
			{% for choice in field %}
			<div class="{{ field.field.type }}">
				<label for="{{ choice.id_for_label }}" class="{% if choice.choice_value in choice.value %}option-checked{% endif %}">
					{{ choice.tag }}
					{{ choice.choice_label|safe }}
				</label>
				{% if choice.choice_value in choice.value and field.field.type == "checkbox" %}
					{% with choice.choice_value as value %}
						<div class="question-feedback">
							{% for hint in field.field.hints|find_hints:value %}
								<p class="help-block help-block-checkbox">
									{{ hint|safe }}
								</p>
							{% endfor %}
						</div>
					{% endwith %}
				{% endif %}
			</div>
			{% endfor %}
			{% include "access/field_errors.html" with errors=field.errors %}

			{% else %}
			<div class="{{ field.field.type }}">
			{{ field.tag }}
			</div>
			{{ field }}
			{% include "access/field_errors.html" with errors=field.errors %}

			{% if field.field.correct %}
			<div data-aplus-once="yes" class="question-feedback">
				<p class="help-block">
					{% trans "Correct answer" %}:
					{{ field.field.correct|safe }}
				</p>
			</div>
			{% endif %}

			{% endif %}

		{% if field.field.type != "checkbox" and not field.field.row_label or field.field.close_table %}
			{% if field.field.hints %}
				<div class="question-feedback">
					{% for hint in field.field.hints %}
					<p class="help-block">{{ hint|safe }}</p>
					{% endfor %}
				</div>
			{% endif %}
		</div>
		{% endif %}

		{% endif %}

	{% if field.field.close_set %}
	</fieldset>
	{% endif %}
	{% if field.field.randomized and not result.accepted %}
	<input type="hidden" name="{{ field.field.name }}_sample" value="{{ field.field.random_sample }}" />
	<input type="hidden" name="{{ field.field.name }}_checksum" value="{{ field.field.random_checksum }}" />
	{% endif %}
	{% endfor %}

	{% if post_url or not result.accepted %}
	<div class="form-group">
		{% if result.form.sample or result.form.checksum %}
		<input type="hidden" name="_sample" value="{{ result.form.sample }}" />
		<input type="hidden" name="_checksum" value="{{ result.form.checksum }}" />
		{% endif %}
		{% if not result.form.disabled %}
		<input type="submit" value="{% trans 'Submit' %}" class="btn btn-primary aplus-submit" />
		{% endif %}
	</div>
	{% endif %}
</form>
